version: '3.8'

services:
  cura:
    image: getsentrix/docker-cura:latest
    container_name: cura
    ports:
      - "3000:3000"
      - "3001:3001"
    environment:
      - CUSTOM_USER=296212
      - CUSTOM_PASSWORD=G2025-2379
      - CUSTOM_PORT=3000
      - CUSTOM_HTTPS_PORT=3001
      - TZ=America/Chicago
      - SELKIES_ENCODER=jpeg
      - SELKIES_FRAMERATE=8-15
      - SELKIES_JPEG_QUALITY=55
      - SELKIES_MANUAL_WIDTH=1024
      - SELKIES_MANUAL_HEIGHT=768
    volumes:
      - cura-config:/root/.local/share/cura
      - cura-models:/root/models
    shm_size: '512mb'          # Lower shared memory for VNC subsystem
    mem_limit: "900m"          # Keep RAM under 1GB (Railway limit)
    cpus: "1.9"                # Use most of your CPU quota, leave some for Railway overhead
    restart: unless-stopped

volumes:
  cura-config:
  cura-models:
